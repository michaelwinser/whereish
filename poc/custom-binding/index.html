<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Whereish PoC - Custom Binding</title>
  <link rel="stylesheet" href="../shared/styles.css">
  <style>
    /* Debug controls */
    .debug-controls {
      padding: 8px 16px;
      background: #f0f0f0;
      border-top: 1px solid #ddd;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .debug-controls button {
      font-size: 0.75rem;
      padding: 4px 8px;
    }
    /* Place-specific styles */
    .place-match {
      background: #e8f5e9;
      border: 1px solid #4caf50;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .place-match-icon { font-size: 1.5rem; }
    .place-item {
      background: #f5f5f5;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 12px;
    }
    .place-item.current { background: #e8f5e9; border: 1px solid #4caf50; }
    .place-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; }
    .place-name { font-weight: 600; }
    .place-current-badge { background: #4caf50; color: white; font-size: 0.7rem; padding: 2px 8px; border-radius: 10px; }
    .place-radius, .place-visibility { font-size: 0.85rem; color: #666; margin-bottom: 4px; }
    .btn-sm { padding: 4px 8px; font-size: 0.75rem; }
    .contact-places { font-size: 0.75rem; color: #4a90d9; margin-top: 2px; }
  </style>
</head>
<body>
  <div class="app">
    <!-- Header -->
    <header class="header">
      <h1>Whereish</h1>
      <div id="status-indicator" class="status-indicator" title="Server connection"></div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="nav-tabs">
      <button class="nav-tab active" data-view="main">Location</button>
      <button class="nav-tab" data-view="places">Places</button>
      <button class="nav-tab" data-view="contacts">
        Contacts
        <span id="contacts-badge"></span>
      </button>
    </nav>

    <!-- Main Content -->
    <main class="content">
      <!-- Main View -->
      <section id="main-view" class="view active">
        <!-- Loading State -->
        <div id="location-loading" class="loading hidden">
          <div class="spinner"></div>
          <span>Getting location...</span>
        </div>

        <!-- Location Card -->
        <div id="location-card" class="location-card">
          <div class="label">Your Location</div>
          <div id="location-display" class="location">Loading...</div>
          <div id="location-timestamp" class="timestamp"></div>
        </div>

        <!-- Current Place Match -->
        <div id="place-match" class="place-match hidden">
          <span class="place-match-icon">üìç</span>
          <span>You are at: <strong id="place-match-name"></strong></span>
        </div>

        <button id="refresh-btn" class="btn btn-primary" style="width: 100%;">
          Refresh Location
        </button>
      </section>

      <!-- Places View -->
      <section id="places-view" class="view">
        <h2 class="section-header">Named Locations</h2>
        <div id="places-list">
          <!-- Rendered by binding -->
        </div>
      </section>

      <!-- Contacts View -->
      <section id="contacts-view" class="view">
        <!-- Pending Invites -->
        <div id="invites-section" class="hidden">
          <h2 class="section-header">Pending Invitations</h2>
          <div id="invites-list"></div>
        </div>

        <!-- Contact List -->
        <h2 class="section-header">Contacts</h2>
        <ul id="contacts-list" class="contact-list">
          <!-- Rendered by binding -->
        </ul>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <span id="app-version">App: v0.0.0</span>
      <span id="server-version">Server: v0.0.0</span>
    </footer>

    <!-- Debug Controls -->
    <div class="debug-controls">
      <button id="toggle-server" class="btn btn-secondary">Toggle Server</button>
      <button id="add-invite" class="btn btn-secondary">Add Invite</button>
      <button class="btn btn-secondary" onclick="handleSimulateLeave()">Leave Place</button>
      <span style="font-size: 0.7rem; color: #666; align-self: center;">
        (Custom Binding PoC)
      </span>
    </div>
  </div>

  <!-- Scripts -->
  <script src="../shared/mock-model.js"></script>
  <script src="bind.js"></script>
  <script src="app.js"></script>
</body>
</html>
